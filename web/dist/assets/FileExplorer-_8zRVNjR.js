import{r as c,j as t,t as Q}from"./index-Cw5LrM1U.js";import{c as Me,a as nt,b as rt,y as Le,r as Qt,R as en,A as tn,g as Pe,h as nn,q as rn,e as Re,f as E,z as ot,E as on,F as an,P as se,G as sn,H as cn,J as un,t as ln,K as dn,D as fn,L as pn,C as xn,i as mn,M as hn,j as be,k as fe,l as pe,m as xe,n as me,N as he,I as ye,O as ge,B as A,s as gn,Q as vn,T as Cn}from"./index-Bjjy5Tnx.js";import{a as S}from"./axios-rQhDmkLL.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const En=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Mn=Me("chevron-right",En);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],je=Me("file",Rn);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const In=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Ye=Me("folder",In);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],qe=Me("link",wn);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],yn=Me("trash",_n);var Ae=["Enter"," "],jn=["ArrowDown","PageUp","Home"],at=["ArrowUp","PageDown","End"],Dn=[...jn,...at],Nn={ltr:[...Ae,"ArrowRight"],rtl:[...Ae,"ArrowLeft"]},Sn={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Ie="Menu",[Ce,Pn,bn]=rn(Ie),[ee,st]=nt(Ie,[bn,rt,ot]),Oe=rt(),ct=ot(),[On,te]=ee(Ie),[Fn,we]=ee(Ie),it=e=>{const{__scopeMenu:n,open:r=!1,children:a,dir:s,onOpenChange:o,modal:u=!0}=e,m=Oe(n),[g,v]=c.useState(null),p=c.useRef(!1),l=Le(o),x=Qt(s);return c.useEffect(()=>{const R=()=>{p.current=!0,document.addEventListener("pointerdown",M,{capture:!0,once:!0}),document.addEventListener("pointermove",M,{capture:!0,once:!0})},M=()=>p.current=!1;return document.addEventListener("keydown",R,{capture:!0}),()=>{document.removeEventListener("keydown",R,{capture:!0}),document.removeEventListener("pointerdown",M,{capture:!0}),document.removeEventListener("pointermove",M,{capture:!0})}},[]),t.jsx(en,{...m,children:t.jsx(On,{scope:n,open:r,onOpenChange:l,content:g,onContentChange:v,children:t.jsx(Fn,{scope:n,onClose:c.useCallback(()=>l(!1),[l]),isUsingKeyboardRef:p,dir:x,modal:u,children:a})})})};it.displayName=Ie;var Tn="MenuAnchor",$e=c.forwardRef((e,n)=>{const{__scopeMenu:r,...a}=e,s=Oe(r);return t.jsx(tn,{...s,...a,ref:n})});$e.displayName=Tn;var Ge="MenuPortal",[An,ut]=ee(Ge,{forceMount:void 0}),lt=e=>{const{__scopeMenu:n,forceMount:r,children:a,container:s}=e,o=te(Ge,n);return t.jsx(An,{scope:n,forceMount:r,children:t.jsx(Pe,{present:r||o.open,children:t.jsx(nn,{asChild:!0,container:s,children:a})})})};lt.displayName=Ge;var P="MenuContent",[kn,Ke]=ee(P),dt=c.forwardRef((e,n)=>{const r=ut(P,e.__scopeMenu),{forceMount:a=r.forceMount,...s}=e,o=te(P,e.__scopeMenu),u=we(P,e.__scopeMenu);return t.jsx(Ce.Provider,{scope:e.__scopeMenu,children:t.jsx(Pe,{present:a||o.open,children:t.jsx(Ce.Slot,{scope:e.__scopeMenu,children:u.modal?t.jsx(Ln,{...s,ref:n}):t.jsx($n,{...s,ref:n})})})})}),Ln=c.forwardRef((e,n)=>{const r=te(P,e.__scopeMenu),a=c.useRef(null),s=Re(n,a);return c.useEffect(()=>{const o=a.current;if(o)return on(o)},[]),t.jsx(Ue,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:E(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),$n=c.forwardRef((e,n)=>{const r=te(P,e.__scopeMenu);return t.jsx(Ue,{...e,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),Ue=c.forwardRef((e,n)=>{const{__scopeMenu:r,loop:a=!1,trapFocus:s,onOpenAutoFocus:o,onCloseAutoFocus:u,disableOutsidePointerEvents:m,onEntryFocus:g,onEscapeKeyDown:v,onPointerDownOutside:p,onFocusOutside:l,onInteractOutside:x,onDismiss:R,disableOutsideScroll:M,...k}=e,b=te(P,r),H=we(P,r),L=Oe(r),ne=ct(r),X=Pn(r),[Te,Y]=c.useState(null),re=c.useRef(null),oe=Re(n,re,b.onContentChange),y=c.useRef(0),$=c.useRef(""),q=c.useRef(0),ce=c.useRef(null),W=c.useRef("right"),ie=c.useRef(0),I=M?un:c.Fragment,_e=M?{as:ln,allowPinchZoom:!0}:void 0,Z=f=>{var D,le;const j=$.current+f,w=X().filter(F=>!F.disabled),O=document.activeElement,K=(D=w.find(F=>F.ref.current===O))==null?void 0:D.textValue,ue=w.map(F=>F.textValue),ae=Zn(ue,j,K),U=(le=w.find(F=>F.textValue===ae))==null?void 0:le.ref.current;(function F(J){$.current=J,window.clearTimeout(y.current),J!==""&&(y.current=window.setTimeout(()=>F(""),1e3))})(j),U&&setTimeout(()=>U.focus())};c.useEffect(()=>()=>window.clearTimeout(y.current),[]),cn();const G=c.useCallback(f=>{var w,O;return W.current===((w=ce.current)==null?void 0:w.side)&&Qn(f,(O=ce.current)==null?void 0:O.area)},[]);return t.jsx(kn,{scope:r,searchRef:$,onItemEnter:c.useCallback(f=>{G(f)&&f.preventDefault()},[G]),onItemLeave:c.useCallback(f=>{var j;G(f)||((j=re.current)==null||j.focus(),Y(null))},[G]),onTriggerLeave:c.useCallback(f=>{G(f)&&f.preventDefault()},[G]),pointerGraceTimerRef:q,onPointerGraceIntentChange:c.useCallback(f=>{ce.current=f},[]),children:t.jsx(I,{..._e,children:t.jsx(dn,{asChild:!0,trapped:s,onMountAutoFocus:E(o,f=>{var j;f.preventDefault(),(j=re.current)==null||j.focus({preventScroll:!0})}),onUnmountAutoFocus:u,children:t.jsx(fn,{asChild:!0,disableOutsidePointerEvents:m,onEscapeKeyDown:v,onPointerDownOutside:p,onFocusOutside:l,onInteractOutside:x,onDismiss:R,children:t.jsx(pn,{asChild:!0,...ne,dir:H.dir,orientation:"vertical",loop:a,currentTabStopId:Te,onCurrentTabStopIdChange:Y,onEntryFocus:E(g,f=>{H.isUsingKeyboardRef.current||f.preventDefault()}),preventScrollOnEntryFocus:!0,children:t.jsx(xn,{role:"menu","aria-orientation":"vertical","data-state":jt(b.open),"data-radix-menu-content":"",dir:H.dir,...L,...k,ref:oe,style:{outline:"none",...k.style},onKeyDown:E(k.onKeyDown,f=>{const w=f.target.closest("[data-radix-menu-content]")===f.currentTarget,O=f.ctrlKey||f.altKey||f.metaKey,K=f.key.length===1;w&&(f.key==="Tab"&&f.preventDefault(),!O&&K&&Z(f.key));const ue=re.current;if(f.target!==ue||!Dn.includes(f.key))return;f.preventDefault();const U=X().filter(D=>!D.disabled).map(D=>D.ref.current);at.includes(f.key)&&U.reverse(),qn(U)}),onBlur:E(e.onBlur,f=>{f.currentTarget.contains(f.target)||(window.clearTimeout(y.current),$.current="")}),onPointerMove:E(e.onPointerMove,Ee(f=>{const j=f.target,w=ie.current!==f.clientX;if(f.currentTarget.contains(j)&&w){const O=f.clientX>ie.current?"right":"left";W.current=O,ie.current=f.clientX}}))})})})})})})});dt.displayName=P;var Gn="MenuGroup",Be=c.forwardRef((e,n)=>{const{__scopeMenu:r,...a}=e;return t.jsx(se.div,{role:"group",...a,ref:n})});Be.displayName=Gn;var Kn="MenuLabel",ft=c.forwardRef((e,n)=>{const{__scopeMenu:r,...a}=e;return t.jsx(se.div,{...a,ref:n})});ft.displayName=Kn;var Ne="MenuItem",We="menu.itemSelect",Fe=c.forwardRef((e,n)=>{const{disabled:r=!1,onSelect:a,...s}=e,o=c.useRef(null),u=we(Ne,e.__scopeMenu),m=Ke(Ne,e.__scopeMenu),g=Re(n,o),v=c.useRef(!1),p=()=>{const l=o.current;if(!r&&l){const x=new CustomEvent(We,{bubbles:!0,cancelable:!0});l.addEventListener(We,R=>a==null?void 0:a(R),{once:!0}),sn(l,x),x.defaultPrevented?v.current=!1:u.onClose()}};return t.jsx(pt,{...s,ref:g,disabled:r,onClick:E(e.onClick,p),onPointerDown:l=>{var x;(x=e.onPointerDown)==null||x.call(e,l),v.current=!0},onPointerUp:E(e.onPointerUp,l=>{var x;v.current||(x=l.currentTarget)==null||x.click()}),onKeyDown:E(e.onKeyDown,l=>{const x=m.searchRef.current!=="";r||x&&l.key===" "||Ae.includes(l.key)&&(l.currentTarget.click(),l.preventDefault())})})});Fe.displayName=Ne;var pt=c.forwardRef((e,n)=>{const{__scopeMenu:r,disabled:a=!1,textValue:s,...o}=e,u=Ke(Ne,r),m=ct(r),g=c.useRef(null),v=Re(n,g),[p,l]=c.useState(!1),[x,R]=c.useState("");return c.useEffect(()=>{const M=g.current;M&&R((M.textContent??"").trim())},[o.children]),t.jsx(Ce.ItemSlot,{scope:r,disabled:a,textValue:s??x,children:t.jsx(an,{asChild:!0,...m,focusable:!a,children:t.jsx(se.div,{role:"menuitem","data-highlighted":p?"":void 0,"aria-disabled":a||void 0,"data-disabled":a?"":void 0,...o,ref:v,onPointerMove:E(e.onPointerMove,Ee(M=>{a?u.onItemLeave(M):(u.onItemEnter(M),M.defaultPrevented||M.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:E(e.onPointerLeave,Ee(M=>u.onItemLeave(M))),onFocus:E(e.onFocus,()=>l(!0)),onBlur:E(e.onBlur,()=>l(!1))})})})}),Un="MenuCheckboxItem",xt=c.forwardRef((e,n)=>{const{checked:r=!1,onCheckedChange:a,...s}=e;return t.jsx(Ct,{scope:e.__scopeMenu,checked:r,children:t.jsx(Fe,{role:"menuitemcheckbox","aria-checked":Se(r)?"mixed":r,...s,ref:n,"data-state":ze(r),onSelect:E(s.onSelect,()=>a==null?void 0:a(Se(r)?!0:!r),{checkForDefaultPrevented:!1})})})});xt.displayName=Un;var mt="MenuRadioGroup",[Bn,Vn]=ee(mt,{value:void 0,onValueChange:()=>{}}),ht=c.forwardRef((e,n)=>{const{value:r,onValueChange:a,...s}=e,o=Le(a);return t.jsx(Bn,{scope:e.__scopeMenu,value:r,onValueChange:o,children:t.jsx(Be,{...s,ref:n})})});ht.displayName=mt;var gt="MenuRadioItem",vt=c.forwardRef((e,n)=>{const{value:r,...a}=e,s=Vn(gt,e.__scopeMenu),o=r===s.value;return t.jsx(Ct,{scope:e.__scopeMenu,checked:o,children:t.jsx(Fe,{role:"menuitemradio","aria-checked":o,...a,ref:n,"data-state":ze(o),onSelect:E(a.onSelect,()=>{var u;return(u=s.onValueChange)==null?void 0:u.call(s,r)},{checkForDefaultPrevented:!1})})})});vt.displayName=gt;var Ve="MenuItemIndicator",[Ct,zn]=ee(Ve,{checked:!1}),Et=c.forwardRef((e,n)=>{const{__scopeMenu:r,forceMount:a,...s}=e,o=zn(Ve,r);return t.jsx(Pe,{present:a||Se(o.checked)||o.checked===!0,children:t.jsx(se.span,{...s,ref:n,"data-state":ze(o.checked)})})});Et.displayName=Ve;var Hn="MenuSeparator",Mt=c.forwardRef((e,n)=>{const{__scopeMenu:r,...a}=e;return t.jsx(se.div,{role:"separator","aria-orientation":"horizontal",...a,ref:n})});Mt.displayName=Hn;var Xn="MenuArrow",Rt=c.forwardRef((e,n)=>{const{__scopeMenu:r,...a}=e,s=Oe(r);return t.jsx(mn,{...s,...a,ref:n})});Rt.displayName=Xn;var Yn="MenuSub",[eo,It]=ee(Yn),ve="MenuSubTrigger",wt=c.forwardRef((e,n)=>{const r=te(ve,e.__scopeMenu),a=we(ve,e.__scopeMenu),s=It(ve,e.__scopeMenu),o=Ke(ve,e.__scopeMenu),u=c.useRef(null),{pointerGraceTimerRef:m,onPointerGraceIntentChange:g}=o,v={__scopeMenu:e.__scopeMenu},p=c.useCallback(()=>{u.current&&window.clearTimeout(u.current),u.current=null},[]);return c.useEffect(()=>p,[p]),c.useEffect(()=>{const l=m.current;return()=>{window.clearTimeout(l),g(null)}},[m,g]),t.jsx($e,{asChild:!0,...v,children:t.jsx(pt,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":s.contentId,"data-state":jt(r.open),...e,ref:hn(n,s.onTriggerChange),onClick:l=>{var x;(x=e.onClick)==null||x.call(e,l),!(e.disabled||l.defaultPrevented)&&(l.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:E(e.onPointerMove,Ee(l=>{o.onItemEnter(l),!l.defaultPrevented&&!e.disabled&&!r.open&&!u.current&&(o.onPointerGraceIntentChange(null),u.current=window.setTimeout(()=>{r.onOpenChange(!0),p()},100))})),onPointerLeave:E(e.onPointerLeave,Ee(l=>{var R,M;p();const x=(R=r.content)==null?void 0:R.getBoundingClientRect();if(x){const k=(M=r.content)==null?void 0:M.dataset.side,b=k==="right",H=b?-5:5,L=x[b?"left":"right"],ne=x[b?"right":"left"];o.onPointerGraceIntentChange({area:[{x:l.clientX+H,y:l.clientY},{x:L,y:x.top},{x:ne,y:x.top},{x:ne,y:x.bottom},{x:L,y:x.bottom}],side:k}),window.clearTimeout(m.current),m.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(l),l.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:E(e.onKeyDown,l=>{var R;const x=o.searchRef.current!=="";e.disabled||x&&l.key===" "||Nn[a.dir].includes(l.key)&&(r.onOpenChange(!0),(R=r.content)==null||R.focus(),l.preventDefault())})})})});wt.displayName=ve;var _t="MenuSubContent",yt=c.forwardRef((e,n)=>{const r=ut(P,e.__scopeMenu),{forceMount:a=r.forceMount,...s}=e,o=te(P,e.__scopeMenu),u=we(P,e.__scopeMenu),m=It(_t,e.__scopeMenu),g=c.useRef(null),v=Re(n,g);return t.jsx(Ce.Provider,{scope:e.__scopeMenu,children:t.jsx(Pe,{present:a||o.open,children:t.jsx(Ce.Slot,{scope:e.__scopeMenu,children:t.jsx(Ue,{id:m.contentId,"aria-labelledby":m.triggerId,...s,ref:v,align:"start",side:u.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:p=>{var l;u.isUsingKeyboardRef.current&&((l=g.current)==null||l.focus()),p.preventDefault()},onCloseAutoFocus:p=>p.preventDefault(),onFocusOutside:E(e.onFocusOutside,p=>{p.target!==m.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:E(e.onEscapeKeyDown,p=>{u.onClose(),p.preventDefault()}),onKeyDown:E(e.onKeyDown,p=>{var R;const l=p.currentTarget.contains(p.target),x=Sn[u.dir].includes(p.key);l&&x&&(o.onOpenChange(!1),(R=m.trigger)==null||R.focus(),p.preventDefault())})})})})})});yt.displayName=_t;function jt(e){return e?"open":"closed"}function Se(e){return e==="indeterminate"}function ze(e){return Se(e)?"indeterminate":e?"checked":"unchecked"}function qn(e){const n=document.activeElement;for(const r of e)if(r===n||(r.focus(),document.activeElement!==n))return}function Wn(e,n){return e.map((r,a)=>e[(n+a)%e.length])}function Zn(e,n,r){const s=n.length>1&&Array.from(n).every(v=>v===n[0])?n[0]:n,o=r?e.indexOf(r):-1;let u=Wn(e,Math.max(o,0));s.length===1&&(u=u.filter(v=>v!==r));const g=u.find(v=>v.toLowerCase().startsWith(s.toLowerCase()));return g!==r?g:void 0}function Jn(e,n){const{x:r,y:a}=e;let s=!1;for(let o=0,u=n.length-1;o<n.length;u=o++){const m=n[o].x,g=n[o].y,v=n[u].x,p=n[u].y;g>a!=p>a&&r<(v-m)*(a-g)/(p-g)+m&&(s=!s)}return s}function Qn(e,n){if(!n)return!1;const r={x:e.clientX,y:e.clientY};return Jn(r,n)}function Ee(e){return n=>n.pointerType==="mouse"?e(n):void 0}var er=it,tr=$e,nr=lt,rr=dt,or=Be,ar=ft,sr=Fe,cr=xt,ir=ht,ur=vt,lr=Et,dr=Mt,fr=Rt,pr=wt,xr=yt,He="ContextMenu",[mr,to]=nt(He,[st]),_=st(),[hr,Dt]=mr(He),Nt=e=>{const{__scopeContextMenu:n,children:r,onOpenChange:a,dir:s,modal:o=!0}=e,[u,m]=c.useState(!1),g=_(n),v=Le(a),p=c.useCallback(l=>{m(l),v(l)},[v]);return t.jsx(hr,{scope:n,open:u,onOpenChange:p,modal:o,children:t.jsx(er,{...g,dir:s,open:u,onOpenChange:p,modal:o,children:r})})};Nt.displayName=He;var St="ContextMenuTrigger",Pt=c.forwardRef((e,n)=>{const{__scopeContextMenu:r,disabled:a=!1,...s}=e,o=Dt(St,r),u=_(r),m=c.useRef({x:0,y:0}),g=c.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...m.current})}),v=c.useRef(0),p=c.useCallback(()=>window.clearTimeout(v.current),[]),l=x=>{m.current={x:x.clientX,y:x.clientY},o.onOpenChange(!0)};return c.useEffect(()=>p,[p]),c.useEffect(()=>void(a&&p()),[a,p]),t.jsxs(t.Fragment,{children:[t.jsx(tr,{...u,virtualRef:g}),t.jsx(se.span,{"data-state":o.open?"open":"closed","data-disabled":a?"":void 0,...s,ref:n,style:{WebkitTouchCallout:"none",...e.style},onContextMenu:a?e.onContextMenu:E(e.onContextMenu,x=>{p(),l(x),x.preventDefault()}),onPointerDown:a?e.onPointerDown:E(e.onPointerDown,De(x=>{p(),v.current=window.setTimeout(()=>l(x),700)})),onPointerMove:a?e.onPointerMove:E(e.onPointerMove,De(p)),onPointerCancel:a?e.onPointerCancel:E(e.onPointerCancel,De(p)),onPointerUp:a?e.onPointerUp:E(e.onPointerUp,De(p))})]})});Pt.displayName=St;var gr="ContextMenuPortal",bt=e=>{const{__scopeContextMenu:n,...r}=e,a=_(n);return t.jsx(nr,{...a,...r})};bt.displayName=gr;var Ot="ContextMenuContent",Ft=c.forwardRef((e,n)=>{const{__scopeContextMenu:r,...a}=e,s=Dt(Ot,r),o=_(r),u=c.useRef(!1);return t.jsx(rr,{...o,...a,ref:n,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:m=>{var g;(g=e.onCloseAutoFocus)==null||g.call(e,m),!m.defaultPrevented&&u.current&&m.preventDefault(),u.current=!1},onInteractOutside:m=>{var g;(g=e.onInteractOutside)==null||g.call(e,m),!m.defaultPrevented&&!s.modal&&(u.current=!0)},style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Ft.displayName=Ot;var vr="ContextMenuGroup",Cr=c.forwardRef((e,n)=>{const{__scopeContextMenu:r,...a}=e,s=_(r);return t.jsx(or,{...s,...a,ref:n})});Cr.displayName=vr;var Er="ContextMenuLabel",Mr=c.forwardRef((e,n)=>{const{__scopeContextMenu:r,...a}=e,s=_(r);return t.jsx(ar,{...s,...a,ref:n})});Mr.displayName=Er;var Rr="ContextMenuItem",Tt=c.forwardRef((e,n)=>{const{__scopeContextMenu:r,...a}=e,s=_(r);return t.jsx(sr,{...s,...a,ref:n})});Tt.displayName=Rr;var Ir="ContextMenuCheckboxItem",wr=c.forwardRef((e,n)=>{const{__scopeContextMenu:r,...a}=e,s=_(r);return t.jsx(cr,{...s,...a,ref:n})});wr.displayName=Ir;var _r="ContextMenuRadioGroup",yr=c.forwardRef((e,n)=>{const{__scopeContextMenu:r,...a}=e,s=_(r);return t.jsx(ir,{...s,...a,ref:n})});yr.displayName=_r;var jr="ContextMenuRadioItem",Dr=c.forwardRef((e,n)=>{const{__scopeContextMenu:r,...a}=e,s=_(r);return t.jsx(ur,{...s,...a,ref:n})});Dr.displayName=jr;var Nr="ContextMenuItemIndicator",Sr=c.forwardRef((e,n)=>{const{__scopeContextMenu:r,...a}=e,s=_(r);return t.jsx(lr,{...s,...a,ref:n})});Sr.displayName=Nr;var Pr="ContextMenuSeparator",At=c.forwardRef((e,n)=>{const{__scopeContextMenu:r,...a}=e,s=_(r);return t.jsx(dr,{...s,...a,ref:n})});At.displayName=Pr;var br="ContextMenuArrow",Or=c.forwardRef((e,n)=>{const{__scopeContextMenu:r,...a}=e,s=_(r);return t.jsx(fr,{...s,...a,ref:n})});Or.displayName=br;var Fr="ContextMenuSubTrigger",Tr=c.forwardRef((e,n)=>{const{__scopeContextMenu:r,...a}=e,s=_(r);return t.jsx(pr,{...s,...a,ref:n})});Tr.displayName=Fr;var Ar="ContextMenuSubContent",kr=c.forwardRef((e,n)=>{const{__scopeContextMenu:r,...a}=e,s=_(r);return t.jsx(xr,{...s,...a,ref:n,style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});kr.displayName=Ar;function De(e){return n=>n.pointerType!=="mouse"?e(n):void 0}var Lr=Nt,$r=Pt,Gr=bt,Kr=Ft,Ur=Tt,Br=At;function Ze({...e}){return t.jsx(Lr,{"data-slot":"context-menu",...e})}function Je({...e}){return t.jsx($r,{"data-slot":"context-menu-trigger",...e})}function Qe({className:e,...n}){return t.jsx(Gr,{children:t.jsx(Kr,{"data-slot":"context-menu-content",className:be("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...n})})}function z({className:e,inset:n,variant:r="default",...a}){return t.jsx(Ur,{"data-slot":"context-menu-item","data-inset":n,"data-variant":r,className:be("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...a})}function Vr({className:e,...n}){return t.jsx(Br,{"data-slot":"context-menu-separator",className:be("bg-border -mx-1 my-1 h-px",e),...n})}var h=(e=>(e.FOLDER="folder",e.FILE="file",e.REFERENCE="reference",e))(h||{});const kt=(e,n)=>e.filter(r=>r.parentId===n),zr=(e,n)=>e.find(r=>r.id===n),Hr=(e,n,r=null)=>{const a={id:`folder-${Date.now()}`,name:n,type:"folder",parentId:r,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return[...e,a]},et=(e,n,r,a=null)=>{const s={id:`file-${Date.now()}`,name:n,type:"file",parentId:a,reportId:r,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return[...e,s]},Xr=(e,n,r)=>e.map(a=>a.id===n?{...a,name:r,updatedAt:new Date().toISOString()}:a),Yr=(e,n,r)=>e.map(a=>a.id===n?{...a,parentId:r,updatedAt:new Date().toISOString()}:a),tt=(e,n,r,a=null,s)=>{const o={id:`ref-${Date.now()}`,name:n,type:"reference",parentId:a,referenceTo:r,reportId:s,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return[...e,o]},ke=(e,n,r=!1)=>{const a=zr(e,n);if(!a)return e;let s=[n];if(a.type==="file"){const o=e.filter(u=>u.type==="reference"&&u.referenceTo===n);s=[...s,...o.map(u=>u.id)]}if(console.log("idsToDelete",s),a.type==="folder"){const o=kt(e,n).map(u=>u.id);if(r){let u=[...e];for(const m of o)u=ke(u,m);return u.filter(m=>m.id!==n)}else{if(o.length===0)return e.filter(u=>u.id!==n);throw new Error("文件夹不为空，无法删除")}}return e.filter(o=>!s.includes(o.id))},qr=(e,n)=>{const r=new Map(e.map(o=>[o.id,o])),a=new Map(n.map(o=>[o.id,o])),s=[];for(const o of n){const u=r.get(o.id);if(!u){o.type===h.FILE?s.push({type:"CREATE_FILE",item:o}):o.type===h.FOLDER?s.push({type:"CREATE_FOLDER",item:o}):o.type===h.REFERENCE&&s.push({type:"CREATE_REFERENCE",item:o});continue}u.type===h.FOLDER&&u.name!==o.name&&s.push({type:"RENAME_FOLDER",item:o,oldItem:u}),u.type===h.FILE&&u.name!==o.name&&s.push({type:"RENAME_FILE",item:o,oldItem:u}),u.parentId!==o.parentId&&s.push({type:"MOVE_ITEM",item:o,oldItem:u}),u.type===h.REFERENCE&&u.name!==o.name&&s.push({type:"RENAME_REFERENCE",item:o,oldItem:u})}for(const o of e)a.get(o.id)||(o.type===h.FILE?s.push({type:"DELETE_FILE",item:o}):o.type===h.FOLDER?s.push({type:"DELETE_FOLDER",item:o}):o.type===h.REFERENCE&&s.push({type:"DELETE_REFERENCE",item:o}));return s},Wr={async getAllItems(){const{data:e}=await S.get("/fs/items");return e},async createFile(e){return(await S.post("/fs/operations/create-file",e)).data},async createFolder(e){return(await S.post("/fs/operations/create-folder",e)).data},async createReference(e){return(await S.post("/fs/operations/create-reference",e)).data},async deleteFile(e){return(await S.delete(`/fs/operations/delete-file/${e}`)).data.success},async deleteFolder(e,n=!1){return(await S.delete(`/fs/operations/delete-folder/${e}`,{params:{recursive:n}})).data.success},async deleteReference(e){return(await S.delete(`/fs/operations/delete-reference/${e}`)).data.success},async renameFolder(e,n){return(await S.put(`/fs/operations/rename-folder/${e}`,null,{params:{new_name:n}})).data},async renameFile(e,n){return(await S.put(`/fs/operations/rename-file/${e}`,null,{params:{new_name:n}})).data},async renameReference(e,n){return(await S.put(`/fs/operations/rename-reference/${e}`,null,{params:{new_name:n}})).data},async moveItem(e,n){return(await S.put(`/fs/operations/move-item/${e}`,null,{params:{new_parent_id:n}})).data},async batchOperations(e){return(await S.post("/fs/batch",{operations:e})).data},async saveFileSystemChanges(e,n){const r=qr(e,n);return r.length===0?{success:!0,results:[]}:this.batchOperations(r)}},no=c.memo(({onSelectItem:e,onDoubleClick:n,useRenameItemEffect:r,useDeleteItemEffect:a,useFileSystemChangeEffect:s})=>{const[o,u]=c.useState([]),[m,g]=c.useState(new Set),[v,p]=c.useState(null),[l,x]=c.useState(null),[R,M]=c.useState(null),[k,b]=c.useState(!1),[H,L]=c.useState(!1),[ne,X]=c.useState(!1),[Te,Y]=c.useState(!1),[re,oe]=c.useState(!1),[y,$]=c.useState(""),[q,ce]=c.useState(null),[W,ie]=c.useState(h.FOLDER),[I,_e]=c.useState(null),[Z,G]=c.useState(""),[f,j]=c.useState(null),[w,O]=c.useState(""),[K,ue]=c.useState(null),[ae,U]=c.useState([]);c.useEffect(()=>{Wr.getAllItems().then(i=>{u(i)})},[]);const D=(i,d)=>{s&&s(i,d),u(d)},le=i=>{const d=new Set(m);d.has(i)?d.delete(i):d.add(i),g(d)},F=i=>{M(i.id),i.type===h.FOLDER?le(i.id):e&&e(i)},J=(i,d)=>{$(""),ce(i),ie(d),b(!0)},Lt=i=>{_e(i),$(i.name),L(!0)},$t=i=>{if(_e(i),i.type===h.FILE){const d=o.filter(C=>C.type===h.REFERENCE&&C.referenceTo===i.id);if(d.length>0){const C=d.map(T=>{let N=T.name,V=T.parentId;for(;V;){const de=o.find(B=>B.id===V);if(!de)break;N=`${de.name}/${N}`,V=de.parentId}return N});U(C)}else U([])}else U([]);X(!0)},Gt=i=>{j(i),G(`${i.name} - 副本`),Y(!0)},Kt=i=>{if(i.type!==h.FILE){Q.error("只能为文件创建引用");return}ue(i),O(`${i.name} 的引用`),oe(!0)},Ut=()=>{if(y.trim()==="")return;if(o.find(C=>C.name===y&&C.parentId===q)){Q.error("同目录下已存在同名文件或文件夹");return}let d;W===h.FOLDER?d=Hr(o,y,q):d=et(o,y,`report-${Date.now()}`,q),D(o,d),b(!1),q&&g(C=>new Set([...C,q]))},Bt=()=>{if(!I||y.trim()==="")return;if(o.find(C=>C.name===y&&C.parentId===I.parentId)){Q.error("同目录下已存在同名文件或文件夹");return}const d=Xr(o,I.id,y);D(o,d),r&&r(d.find(C=>C.id===I.id)),L(!1)},Vt=()=>{if(!f||Z.trim()==="")return;if(o.find(C=>C.name===Z&&C.parentId===f.parentId)){Q.error("同目录下已存在同名文件或文件夹");return}let d;if(f.type===h.REFERENCE){const C=f.referenceTo;d=tt(o,Z,C,f.parentId,f.reportId)}else d=et(o,Z,`report-${Date.now()}`,f.parentId);D(o,d),Y(!1)},zt=()=>{if(!K||w.trim()==="")return;if(o.find(C=>C.name===w&&C.parentId===K.parentId)){Q.error("同目录下已存在同名文件或文件夹");return}const d=tt(o,w,K.id,K.parentId,K.reportId);D(o,d),oe(!1)},Ht=()=>{if(I){if(I.type===h.FILE||I.type===h.REFERENCE){const i=ke(o,I.id);D(o,i),a&&a(I)}if(I.type===h.FOLDER)try{const i=ke(o,I.id,!1);D(o,i)}catch(i){Q.error(i.message)}X(!1)}},Xt=(i,d)=>{p({id:d.id,name:d.name,type:d.type}),i.dataTransfer.effectAllowed="move",i.dataTransfer.setData("application/json",JSON.stringify({id:d.id,type:d.type}))},Yt=()=>{p(null),x(null)},qt=(i,d)=>{i.preventDefault(),i.stopPropagation(),d.type===h.FOLDER?(x(d.id),i.dataTransfer.dropEffect="move"):i.dataTransfer.dropEffect="none"},Wt=()=>{x(null)},Zt=(i,d)=>{if(i.preventDefault(),i.stopPropagation(),!v||d.type!==h.FOLDER||v.id===d.id)return;if(o.find(N=>N.name===v.name&&N.parentId===d.id)){Q.error("同目录下已存在同名文件或文件夹，无法移动");return}const T=Yr(o,v.id,d.id);D(o,T),g(N=>new Set([...N,d.id])),p(null),x(null)},Jt=i=>{const d=i.type===h.FOLDER,C=i.type===h.REFERENCE,T=d&&m.has(i.id),N=(v==null?void 0:v.id)===i.id,V=l===i.id,de=R===i.id;return t.jsxs("div",{className:"select-none",children:[t.jsxs(Ze,{children:[t.jsx(Je,{children:t.jsxs("div",{className:be("flex items-center px-2 py-1.5 rounded-md cursor-pointer transition-colors group",N?"opacity-50":"",V?"bg-blue-100 dark:bg-blue-900/40":de?"bg-secondary":"hover:bg-secondary/50"),onClick:()=>F(i),onDoubleClick:()=>n&&n(i),draggable:!0,onDragStart:B=>Xt(B,i),onDragEnd:Yt,onDragOver:B=>qt(B,i),onDragLeave:Wt,onDrop:B=>Zt(B,i),children:[t.jsx("div",{className:"w-5 h-5 flex items-center justify-center mr-1 flex-shrink-0",children:d&&t.jsx("button",{onClick:B=>{B.stopPropagation(),le(i.id)},className:"focus:outline-none",children:T?t.jsx(gn,{size:16,className:"text-muted-foreground"}):t.jsx(Mn,{size:16,className:"text-muted-foreground"})})}),t.jsx("div",{className:"mr-2 flex-shrink-0",children:d?t.jsx(Ye,{size:18,className:"text-blackAlpha.900"}):C?t.jsx(qe,{size:18,className:"text-blue-500"}):t.jsx(je,{size:18,className:"text-muted-foreground"})}),t.jsx("div",{className:"flex-1 truncate text-sm",title:i.name,children:i.name})]})}),t.jsxs(Qe,{className:"w-56",children:[d&&t.jsxs(t.Fragment,{children:[t.jsxs(z,{onClick:()=>J(i.id,h.FOLDER),children:[t.jsx(vn,{className:"mr-2 h-4 w-4"}),t.jsx("span",{children:"新建文件夹"})]}),t.jsxs(z,{onClick:()=>J(i.id,h.FILE),children:[t.jsx(je,{className:"mr-2 h-4 w-4"}),t.jsx("span",{children:"新建文件"})]}),t.jsx(Vr,{})]}),t.jsxs(z,{onClick:()=>Lt(i),children:[t.jsx(Cn,{className:"mr-2 h-4 w-4"}),t.jsx("span",{children:"重命名"})]}),t.jsxs(z,{onClick:()=>$t(i),children:[t.jsx(yn,{className:"mr-2 h-4 w-4"}),t.jsx("span",{children:"删除"})]}),i.type===h.FILE&&t.jsx(t.Fragment,{children:t.jsxs(z,{onClick:()=>Kt(i),children:[t.jsx(qe,{className:"mr-2 h-4 w-4"}),t.jsx("span",{children:"创建引用"})]})}),i.type!==h.FOLDER&&t.jsxs(z,{onClick:()=>Gt(i),children:[t.jsx(je,{className:"mr-2 h-4 w-4"}),t.jsx("span",{children:i.type===h.REFERENCE?"复制引用":"复制文件"})]})]})]}),d&&T&&t.jsx("div",{className:"pl-5 mt-0.5 border-l ml-2.5 border-border/50",children:Xe(i.id)})]},i.id)},Xe=i=>[...kt(o,i)].sort((T,N)=>{const V={[h.FOLDER]:0,[h.FILE]:1,[h.REFERENCE]:2};return V[T.type]-V[N.type]||T.name.localeCompare(N.name)}).map(Jt);return t.jsxs("div",{className:"h-full flex flex-col",children:[t.jsxs(Ze,{children:[t.jsx(Je,{className:"flex-1 overflow-auto pr-1 min-w-0",children:t.jsxs("div",{className:"space-y-0.5",children:[Xe(null),o.length===0&&t.jsx("div",{className:"text-center text-muted-foreground py-4",children:"右键添加文件或文件夹"})]})}),t.jsxs(Qe,{className:"w-56",children:[t.jsxs(z,{onClick:()=>J(null,h.FOLDER),children:[t.jsx(Ye,{className:"mr-2 h-4 w-4 text-gray-500"}),t.jsx("span",{children:"新建文件夹"})]}),t.jsxs(z,{onClick:()=>J(null,h.FILE),children:[t.jsx(je,{className:"mr-2 h-4 w-4"}),t.jsx("span",{children:"新建文件"})]})]})]}),t.jsx(fe,{open:k,onOpenChange:b,children:t.jsxs(pe,{children:[t.jsxs(xe,{children:[t.jsx(me,{children:W===h.FOLDER?"新建文件夹":"新建文件"}),t.jsxs(he,{children:["请输入",W===h.FOLDER?"文件夹":"文件","名称"]})]}),t.jsx(ye,{value:y,onChange:i=>$(i.target.value),placeholder:W===h.FOLDER?"文件夹名称":"文件名称",autoFocus:!0}),t.jsxs(ge,{children:[t.jsx(A,{variant:"outline",onClick:()=>b(!1),children:"取消"}),t.jsx(A,{onClick:Ut,children:"创建"})]})]})}),t.jsx(fe,{open:H,onOpenChange:L,children:t.jsxs(pe,{children:[t.jsxs(xe,{children:[t.jsx(me,{children:"重命名"}),t.jsx(he,{children:"请输入新的名称"})]}),t.jsx(ye,{value:y,onChange:i=>$(i.target.value),placeholder:"新名称",autoFocus:!0}),t.jsxs(ge,{children:[t.jsx(A,{variant:"outline",onClick:()=>L(!1),children:"取消"}),t.jsx(A,{onClick:Bt,children:"确定"})]})]})}),t.jsx(fe,{open:ne,onOpenChange:X,children:t.jsxs(pe,{children:[t.jsxs(xe,{children:[t.jsx(me,{children:"确认删除"}),t.jsx(he,{children:(I==null?void 0:I.type)===h.FOLDER?"删除文件夹将同时删除其中的所有内容，此操作不可撤销。":(I==null?void 0:I.type)===h.FILE&&ae.length>0?t.jsxs(t.Fragment,{children:[t.jsxs("span",{children:["此文件有 ",ae.length," ","个引用，删除后这些引用将失效："]}),t.jsx("div",{className:"bg-muted p-2 rounded-md text-xs max-h-32 overflow-y-auto",children:ae.map((i,d)=>t.jsx("div",{className:"pb-1 border-b border-border/50 last:border-0 last:pb-0 mb-1 last:mb-0",children:i},d))}),t.jsx("span",{className:"text-destructive",children:"确定要删除此文件吗？此操作不可撤销。"})]}):"确定要删除此文件吗？此操作不可撤销。"})]}),t.jsxs(ge,{children:[t.jsx(A,{variant:"outline",onClick:()=>X(!1),children:"取消"}),t.jsx(A,{variant:"destructive",onClick:Ht,children:"删除"})]})]})}),t.jsx(fe,{open:Te,onOpenChange:Y,children:t.jsxs(pe,{children:[t.jsxs(xe,{children:[t.jsx(me,{children:"复制文件"}),t.jsx(he,{children:"请输入新文件名"})]}),t.jsx(ye,{value:Z,onChange:i=>G(i.target.value),placeholder:"新文件名",autoFocus:!0}),t.jsxs(ge,{children:[t.jsx(A,{variant:"outline",onClick:()=>Y(!1),children:"取消"}),t.jsx(A,{onClick:Vt,children:"确定"})]})]})}),t.jsx(fe,{open:re,onOpenChange:oe,children:t.jsxs(pe,{children:[t.jsxs(xe,{children:[t.jsx(me,{children:"创建引用"}),t.jsx(he,{children:"请输入引用名称"})]}),t.jsx(ye,{value:w,onChange:i=>O(i.target.value),placeholder:"引用名称",autoFocus:!0}),t.jsxs(ge,{children:[t.jsx(A,{variant:"outline",onClick:()=>oe(!1),children:"取消"}),t.jsx(A,{onClick:zt,children:"创建"})]})]})})]})});export{Mn as C,no as F,Wr as f};
